package com.rules4j.engine;

import java.util.Map;
import java.util.stream.Stream;

import com.rules4j.data.IRule;
import com.rules4j.helpers.ObjectHelper;
import com.rules4j.repository.IRuleStore;

public class RuleEngine implements IRuleEngine {
	private IRuleStore store;

	public RuleEngine(IRuleStore store) {
		this.store = store;
	}

	@Override
	public Stream<IRule> evaluate(Map<String, Object> data) {
        return store.get().stream().filter(r -> r.getFilters().stream().allMatch(f -> f.evaluate(data)));
	}

	@Override
	public Stream<IRule> evaluate(Object data) {
        return this.Evaluate(ObjectHelper.toMap(data)(data));
	}

	@Override
	public Stream<IRule> evaluateAndFire(Map<String, Object> data) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Stream<IRule> evaluateAndFire(Object data) {
		// TODO Auto-generated method stub
		return null;
	}
}
